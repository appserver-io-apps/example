<?xml version="1.0" encoding="UTF-8"?>
<di xmlns="http://www.appserver.io/appserver">
    <preferences>
        <preference>
            <interface>TechDivision\Import\Utils\Generators\GeneratorInterface</interface>
            <class>TechDivision\Import\Utils\Generators\CoreConfigDataUidGenerator</class>
        </preference>
    </preferences>
    <beans>
        <bean>
            <name>LoggerFactory</name>
            <class>AppserverIo\Apps\Example\Logger\LoggerFactory</class>
            <bean-ref>
                <bean-ref-name>Configuration</bean-ref-name>
                <injection-target>
                    <injection-target-class>AppserverIo\Apps\Example\Logger\LoggerFactory</injection-target-class>
                    <injection-target-property>configuration</injection-target-property>
                </injection-target>
            </bean-ref>
            <res-ref>
                <res-ref-name>SystemLogger</res-ref-name>
                <lookup-name>php:global/log/System</lookup-name>
                <injection-target>
                    <injection-target-class>AppserverIo\Apps\Example\Logger\LoggerFactory</injection-target-class>
                    <injection-target-property>systemLogger</injection-target-property>
                </injection-target>
            </res-ref>
        </bean>
        <bean>
            <name>ConfigurationFactory</name>
            <class>AppserverIo\Apps\Example\Configuration\ConfigurationFactory</class>
            <res-ref>
                <res-ref-name>ApplicationInterface</res-ref-name>
                <injection-target>
                    <injection-target-class>AppserverIo\Apps\Example\Logger\LoggerFactory</injection-target-class>
                    <injection-target-property>application</injection-target-property>
                </injection-target>
            </res-ref>
        </bean>
        <bean>
            <name>LexerConfigFactory</name>
            <class>TechDivision\Import\Adapter\Csv\LexerConfigFactory</class>
            <bean-ref>
                <bean-ref-name>Configuration</bean-ref-name>
            </bean-ref>
        </bean>
        <bean>
            <name>PluginFactory</name>
            <class>AppserverIo\Apps\Example\Plugins\PluginFactory</class>
            <res-ref>
                <res-ref-name>ProviderInterface</res-ref-name>
            </res-ref>
        </bean>
        <bean>
            <name>SubjectFactory</name>
            <class>AppserverIo\Apps\Example\Subjects\SubjectFactory</class>
            <res-ref>
                <res-ref-name>ProviderInterface</res-ref-name>
            </res-ref>
        </bean>
        <bean>
            <name>Configuration</name>
            <class>TechDivision\Import\ConfigurationInterface</class>
            <factory>
                <name>ConfigurationFactory</name>
                <method>createConfiguration</method>
            </factory>
        </bean>
        <bean>
            <name>SystemLoggers</name>
            <class>Doctrine\Common\Collections\Collection</class>
            <factory>
                <name>LoggerFactory</name>
                <method>factory</method>
            </factory>
        </bean>
        <bean>
            <name>LexerConfig</name>
            <class>Goodby\CSV\Import\Standard\LexerConfig</class>
            <factory>
                <name>LexerConfigFactory</name>
                <method>createLexerConfig</method>
            </factory>
        </bean>
        <bean>
            <name>CsvImportAdapter</name>
            <class>TechDivision\Import\Adapter\CsvImportAdapter</class>
            <bean-ref>
                <bean-ref-name>Lexer</bean-ref-name>
            </bean-ref>
            <bean-ref>
                <bean-ref-name>Interpreter</bean-ref-name>
            </bean-ref>
        </bean>
        <bean>
            <name>Lexer</name>
            <class>TechDivision\Import\Adapter\Goodby\Lexer</class>
            <bean-ref>
                <bean-ref-name>LexerConfig</bean-ref-name>
            </bean-ref>
        </bean>
        <bean>
            <name>Interpreter</name>
            <class>TechDivision\Import\Adapter\Goodby\Interpreter</class>
        </bean>
        <bean>
            <name>CallbackVisitor</name>
            <class>AppserverIo\Apps\Example\Callbacks\CallbackVisitor</class>
            <res-ref>
                <res-ref-name>ProviderInterface</res-ref-name>
            </res-ref>
        </bean>
        <bean>
            <name>ObserverVisitor</name>
            <class>AppserverIo\Apps\Example\Observers\ObserverVisitor</class>
            <res-ref>
                <res-ref-name>ProviderInterface</res-ref-name>
            </res-ref>
        </bean>
        <bean>
            <name>ArchivePlugin</name>
            <class>TechDivision\Import\Plugins\ArchivePlugin</class>
            <epb-ref>
                <epb-ref-name>ImportApplication</epb-ref-name>
            </epb-ref>
        </bean>
        <bean>
            <name>SubjectPlugin</name>
            <class>TechDivision\Import\Plugins\SubjectPlugin</class>
            <epb-ref>
                <epb-ref-name>ImportApplication</epb-ref-name>
            </epb-ref>
            <bean-ref>
                <bean-ref-name>CallbackVisitor</bean-ref-name>
            </bean-ref>
            <bean-ref>
                <bean-ref-name>ObserverVisitor</bean-ref-name>
            </bean-ref>
            <bean-ref>
                <bean-ref-name>SubjectFactory</bean-ref-name>
            </bean-ref>
        </bean>
        <bean>
            <name>MoveFilesSubject</name>
            <class>TechDivision\Import\Subjects\MoveFilesSubject</class>
            <epb-ref>
                <epb-ref-name>RegistryProcessor</epb-ref-name>
            </epb-ref>
            <bean-ref>
                <bean-ref-name>GeneratorInterface</bean-ref-name>
                <bean-ref-type>TechDivision\Import\Utils\Generators\GeneratorInterface</bean-ref-type>
            </bean-ref>
            <bean-ref>
                <bean-ref-name>SystemLoggers</bean-ref-name>
            </bean-ref>
        </bean>
        <bean>
            <name>ProductSubject</name>
            <class>AppserverIo\Apps\Example\Subjects\ProductSubject</class>
            <epb-ref>
                <epb-ref-name>RegistryProcessor</epb-ref-name>
            </epb-ref>
            <bean-ref>
                <bean-ref-name>GeneratorInterface</bean-ref-name>
                <bean-ref-type>TechDivision\Import\Utils\Generators\GeneratorInterface</bean-ref-type>
            </bean-ref>
            <bean-ref>
                <bean-ref-name>SystemLoggers</bean-ref-name>
            </bean-ref>
        </bean>
        <bean>
            <name>ProductObserver</name>
            <class>AppserverIo\Apps\Example\Observers\ProductObserver</class>
            <res-ref>
                <res-ref-name>ProviderInterface</res-ref-name>
                <injection-target>
                    <injection-target-class>AppserverIo\Apps\Example\Observers\ProductObserver</injection-target-class>
                    <injection-target-property>providerInterface</injection-target-property>
                </injection-target>
            </res-ref>
            <persistence-unit-ref>
                <persistence-unit-ref-name>EntityManager</persistence-unit-ref-name>
                <persistence-unit-name>ExampleEntityManager</persistence-unit-name>
                <injection-target>
                    <injection-target-class>AppserverIo\Apps\Example\Observers\ProductObserver</injection-target-class>
                    <injection-target-property>entityManager</injection-target-property>
                </injection-target>
            </persistence-unit-ref>
        </bean>
    </beans>
</di>